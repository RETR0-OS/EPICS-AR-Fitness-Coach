# AI Documentation

## Requirements.txt
Contains the different dependencies and their version numbers for the Python-based AI application.

## Dev_tests Directory
The Dev tests directory contains test code to test isolated features of the application. Dev tests directory code is **NOT** to be pushed to production.
### stream_from_webcam.py
This file contains test code to stream the video from the webcam of a device. The application may or may not use the code, depending upon whether video streaming is handled in python or JavaScript.
### yolo_human_detection.py
This script opens the device's webcam and streams the footage. The streamed footage is then passed through the YOLOv8 algorithm to detect the bounding box for the primary person in the image. The footage is then cropped to the bounding box containing the primary person. The cropped image will later be passed to ViTPose for Key-point detection.
### yolov8s.pt
The pre-trained YOLOv8 weights by Ultralytics downloaded by the ultralytics library required to run inferences.

### pose_estimation.py
Extends the YOLOv8 human detection script to include pose estimation using the ViTPose algorithm. The script resizes the input frame to match the ViTPose model's input size instead of cropping to save on computation on key-point calculation and then passes the frame to the ViTPose model to get the key points. The inferred keypoints are then drawn on the frame and the corresponding skeletion is generated. The frame is then displayed on the screen. The script uses GPU inference for the ViTPose model, if available in the environment. The device-agnostic code ensure that the script runs in both environments with a GPU and ones without, while providing maximum efficiency.

## Dev_tests/flask_server Directory
This directory contains the code for a Flask server that is used to serve the AI inference endpoint. The server receives the webcam stream from the client and generates the inferences on the frames of that stream. The server then sends the inferences back to the client for display.

### keypoint_builder.py
Defines a class to build an object that can be used to detect the main person in a frame and infer the key points of a person detected in the frame. The class also contains methods to draw the key points on the frame and generate the skeleton of the person.

### stream_external_vid.py
Contains the test flask server code to stream the video from the webcam of a device. This simple server is meant to simulate the webcam stream being sent from the frontend to the backend.

### index.html
The HTML file that contains the code for the dummy client-side of the application. The file contains the code to stream the webcam feed to the backend server and display the inferences generated by the server.